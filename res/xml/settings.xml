<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto">
  <PreferenceCategory android:title="@string/pref_category_layout">
    <juloo.keyboard2.prefs.LayoutsPreference/>
    <PreferenceScreen android:title="@string/pref_extra_keys_title">
      <PreferenceCategory android:title="@string/pref_extra_keys_custom">
        <juloo.keyboard2.prefs.CustomExtraKeysPreference/>
      </PreferenceCategory>
      <juloo.keyboard2.prefs.ExtraKeysPreference android:title="@string/pref_extra_keys_internal"/>
    </PreferenceScreen>
    <ListPreference android:key="number_row" android:title="@string/pref_number_row_title" android:summary="%s" android:defaultValue="no_number_row" android:entries="@array/pref_show_number_row_entries" android:entryValues="@array/pref_show_number_row_values"/>
    <ListPreference android:key="show_numpad" android:title="@string/pref_show_numpad_title" android:summary="%s" android:defaultValue="1" android:entries="@array/pref_show_numpad_entries" android:entryValues="@array/pref_show_numpad_values"/>
    <ListPreference android:key="numpad_layout" android:title="@string/pref_numpad_layout" android:summary="%s" android:defaultValue="high_first" android:entries="@array/pref_numpad_layout_entries" android:entryValues="@array/pref_numpad_layout_values"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="@string/pref_category_typing">
    <CheckBoxPreference android:key="word_prediction_enabled" android:title="@string/pref_word_prediction_title" android:summary="@string/pref_word_prediction_summary" android:defaultValue="false"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="suggestion_bar_opacity" android:title="@string/pref_suggestion_bar_opacity_title" android:summary="%s%%" android:defaultValue="90" min="0" max="100" android:dependency="word_prediction_enabled"/>
    <PreferenceScreen android:key="word_prediction_advanced" android:title="Advanced Word Prediction" android:summary="Fine-tune typing suggestion scoring weights" android:dependency="word_prediction_enabled">
      <Preference android:title="ðŸ“– About Prediction Weights" android:summary="These settings control how regular typing predictions are ranked:\n\nâ€¢ Context Boost: How much previous words influence suggestions\nâ€¢ Frequency Scale: Balance between common and uncommon words\n\nHigher context boost = better contextual predictions\nLower frequency scale = more variety in suggestions"/>
      <CheckBoxPreference android:key="context_aware_predictions_enabled" android:title="ðŸ§  Context-Aware Predictions (Phase 7.1)" android:summary="Learn from your typing patterns to provide personalized predictions" android:defaultValue="true"/>
      <Preference android:title="ðŸ“– About Context-Aware Predictions" android:summary="Dynamic N-gram model that learns from your typing:\n\nâ€¢ Learns word pairs (bigrams) from your typing history\nâ€¢ Provides personalized prediction boosts\nâ€¢ Example: After 'I want', suggests 'to' with 2.5x boost\nâ€¢ Privacy-first: All learning stays on your device\nâ€¢ Auto-saves to SharedPreferences\n\nDisable if you prefer static predictions only." android:dependency="context_aware_predictions_enabled"/>
      <CheckBoxPreference android:key="personalized_learning_enabled" android:title="â­ Personalized Learning (Phase 7.2)" android:summary="Boost predictions for words you frequently type" android:defaultValue="true"/>
      <Preference android:title="ðŸ“– About Personalized Learning" android:summary="Adaptive prediction system that learns your vocabulary:\n\nâ€¢ Tracks word usage frequency and recency\nâ€¢ Boosts words you type often (up to 2.5x)\nâ€¢ Frequency score: 1-100 uses â†’ 1.0-3.0x boost\nâ€¢ Recency decay: Recent (7 days) â†’ 1.0x, Old (90 days) â†’ 0.0x\nâ€¢ Example: Type 'kotlin' 50 times â†’ gets 2.2x boost\nâ€¢ Privacy-first: All data stored locally\nâ€¢ Auto-cleanup: removes words unused for 90+ days\n\nDisable if you prefer static predictions only." android:dependency="personalized_learning_enabled"/>
      <ListPreference android:key="learning_aggression" android:title="Learning Aggression" android:summary="How strongly your typing habits affect predictions (%s)" android:defaultValue="BALANCED" android:entries="@array/pref_learning_aggression_entries" android:entryValues="@array/pref_learning_aggression_values" android:dependency="personalized_learning_enabled"/>
      <juloo.keyboard2.prefs.SlideBarPreference android:key="prediction_context_boost" android:title="Context Boost Multiplier" android:summary="How strongly context influences predictions (%s)" android:defaultValue="2.0" min="0.5" max="5.0"/>
      <juloo.keyboard2.prefs.SlideBarPreference android:key="prediction_frequency_scale" android:title="Frequency Scaling Factor" android:summary="Balance common vs uncommon words (%s)" android:defaultValue="1000.0" min="100.0" max="5000.0"/>
    </PreferenceScreen>
    <PreferenceScreen android:key="autocorrect_settings" android:title="âœ¨ Auto-Correction" android:summary="Automatically fix common typing mistakes" android:dependency="word_prediction_enabled">
      <CheckBoxPreference android:key="autocorrect_enabled" android:title="Enable Auto-Correction" android:summary="Automatically correct typos when you press space" android:defaultValue="true"/>
      <Preference android:title="ðŸ“– About Auto-Correction" android:summary="Fixes typos by finding dictionary words with:\n\nâ€¢ Same length\nâ€¢ Same first 2 letters\nâ€¢ Similar characters (default: 2/3 match)\n\nExample: 'teh' â†’ 'the', 'Teh' â†’ 'The'\n\nTap corrected word in suggestions to undo." android:dependency="autocorrect_enabled"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_min_word_length" android:title="Minimum Word Length" android:summary="Don't correct words shorter than %s letters" android:defaultValue="3" min="2" max="5" android:dependency="autocorrect_enabled"/>
      <juloo.keyboard2.prefs.SlideBarPreference android:key="autocorrect_char_match_threshold" android:title="Character Match Threshold" android:summary="How many characters must match (%s)" android:defaultValue="0.67" min="0.5" max="0.9" android:dependency="autocorrect_enabled"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_confidence_min_frequency" android:title="Minimum Frequency" android:summary="Only correct to words with frequency â‰¥ %s" android:defaultValue="500" min="100" max="5000" android:dependency="autocorrect_enabled"/>
    </PreferenceScreen>
    <Preference android:key="dictionary_manager" android:title="ðŸ“š Dictionary Manager" android:summary="Manage active, disabled, user, and custom dictionary words"/>
    <CheckBoxPreference android:key="swipe_typing_enabled" android:title="@string/pref_swipe_typing_title" android:summary="@string/pref_swipe_typing_summary" android:defaultValue="true"/>
    <PreferenceScreen android:key="swipe_calibration" android:title="@string/pref_swipe_calibration_title" android:summary="@string/pref_swipe_calibration_summary" android:dependency="swipe_typing_enabled"/>
    <PreferenceScreen android:key="neural_swipe_settings" android:title="ðŸ§  Neural Prediction Settings" android:summary="Configure ONNX transformer neural network parameters" android:dependency="swipe_typing_enabled">
      <CheckBoxPreference android:key="neural_prediction_enabled" android:title="Enable Neural Prediction" android:summary="Use ONNX transformer for swipe recognition" android:defaultValue="true"/>
      <Preference android:key="neural_performance_stats" android:title="ðŸ“Š Performance Statistics" android:summary="View neural prediction accuracy and performance metrics"/>
      <CheckBoxPreference android:key="termux_mode_enabled" android:title="ðŸ“± Termux Mode" android:summary="Insert predictions in Termux-compatible way for terminal usage" android:defaultValue="false"/>
      <PreferenceScreen android:key="neural_beam_search" android:title="Beam Search Configuration" android:summary="Control neural decoding parameters">
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="neural_beam_width" android:title="Beam Width" android:summary="Number of parallel prediction paths (%s)" android:defaultValue="2" min="1" max="16" android:dependency="neural_prediction_enabled"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="neural_max_length" android:title="Maximum Length" android:summary="Maximum word length for predictions (%s)" android:defaultValue="35" min="10" max="50" android:dependency="neural_prediction_enabled"/>
        <CheckBoxPreference android:key="neural_batch_beams" android:title="âš¡ Batch Processing" android:summary="Process all beams in single inference (experimental, faster but may error)" android:defaultValue="false" android:dependency="neural_prediction_enabled"/>
        <CheckBoxPreference android:key="neural_greedy_search" android:title="Greedy Search" android:summary="Fastest speed, but lower accuracy" android:defaultValue="false" android:dependency="neural_prediction_enabled"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="neural_beam_alpha" android:title="Length Normalization" android:summary="Reward longer words (alpha=%s). Higher values prefer longer words. (Default: 1.2)" android:defaultValue="1.2" min="0.0" max="5.0" android:dependency="neural_prediction_enabled"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="neural_beam_prune_confidence" android:title="Pruning Confidence" android:summary="Minimum confidence to reduce beam width (%s). Higher values correspond to safer pruning. (Default: 0.8)" android:defaultValue="0.8" min="0.0" max="1.0" android:dependency="neural_prediction_enabled"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="neural_beam_score_gap" android:title="Early Stop Gap" android:summary="Score difference required to stop early (%s). Higher values search longer. (Default: 5.0)" android:defaultValue="5.0" min="0.0" max="20.0" android:dependency="neural_prediction_enabled"/>
        <Preference android:key="neural_beam_info" android:title="ðŸ“– About Beam Search" android:summary="Beam search controls how the neural network generates predictions:\n\nâ€¢ Beam Width: More paths = better accuracy, slower speed\nâ€¢ Max Length: Longer words supported with higher values\nâ€¢ Batch Processing: Experimental speed optimization\nâ€¢ Optimal: Width=8, Length=35 for balanced performance"/>
      </PreferenceScreen>
      <PreferenceScreen android:key="neural_confidence" android:title="Confidence Filtering" android:summary="Control prediction quality thresholds">
        <juloo.keyboard2.prefs.SlideBarPreference android:key="neural_confidence_threshold" android:title="Confidence Threshold" android:summary="Minimum confidence for predictions (%s)" android:defaultValue="0.1" min="0.0" max="1.0" android:dependency="neural_prediction_enabled"/>
        <Preference android:key="neural_confidence_info" android:title="ðŸ“– About Confidence" android:summary="Confidence threshold filters low-quality predictions:\n\nâ€¢ Lower values = More predictions shown\nâ€¢ Higher values = Only high-confidence predictions\nâ€¢ Range: 0.0 (show all) to 1.0 (perfect confidence only)\nâ€¢ Optimal: 0.1 for balanced filtering"/>
      </PreferenceScreen>
      <PreferenceScreen android:key="neural_model_config" android:title="Model Configuration" android:summary="Select model version and trajectory processing">
        <Preference android:key="neural_model_metadata" android:title="ðŸ” Model Information" android:summary="View loaded model details and usage statistics"/>
        <Preference android:key="neural_model_info" android:title="@string/pref_neural_model_info_title" android:summary="@string/pref_neural_model_info_summary" android:selectable="false"/>
        <ListPreference android:key="neural_model_version" android:title="@string/pref_neural_model_version_title" android:summary="@string/pref_neural_model_version_summary" android:defaultValue="v2" android:entries="@array/pref_neural_model_version_entries" android:entryValues="@array/pref_neural_model_version_values" android:dependency="neural_prediction_enabled"/>
        <CheckBoxPreference android:key="neural_use_quantized" android:title="Use INT8 Quantized Models (Experimental)" android:summary="Faster inference but lower accuracy (73.4% vs 80.6%). May produce unstable predictions." android:defaultValue="false" android:dependency="neural_prediction_enabled"/>
        <Preference android:key="neural_load_encoder" android:title="@string/pref_neural_load_encoder_title" android:summary="@string/pref_neural_load_encoder_summary"/>
        <Preference android:key="neural_load_decoder" android:title="@string/pref_neural_load_decoder_title" android:summary="@string/pref_neural_load_decoder_summary"/>
        <Preference android:key="neural_external_models_info" android:title="@string/pref_neural_external_models_info_title" android:summary="@string/pref_neural_external_models_info_summary"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="neural_user_max_seq_length" android:title="@string/pref_neural_user_max_seq_length_title" android:summary="@string/pref_neural_user_max_seq_length_summary" android:defaultValue="0" min="0" max="400" android:dependency="neural_prediction_enabled"/>
        <ListPreference android:key="neural_resampling_mode" android:title="@string/pref_neural_resampling_mode_title" android:summary="@string/pref_neural_resampling_mode_summary" android:defaultValue="discard" android:entries="@array/pref_neural_resampling_mode_entries" android:entryValues="@array/pref_neural_resampling_mode_values" android:dependency="neural_prediction_enabled"/>
        <Preference android:key="neural_resampling_info" android:title="@string/pref_neural_resampling_info_title" android:summary="@string/pref_neural_resampling_info_summary"/>
      </PreferenceScreen>
      <PreferenceScreen android:key="neural_ab_testing" android:title="ðŸ§ª A/B Testing" android:summary="Compare and test different model versions">
        <Preference android:key="ab_test_status" android:title="ðŸ“Š Test Status" android:summary="View current A/B test progress and results"/>
        <Preference android:key="ab_test_comparison" android:title="ðŸ“ˆ Model Comparison" android:summary="Compare performance metrics between models"/>
        <Preference android:key="ab_test_configure" android:title="âš™ï¸ Configure Test" android:summary="Set up A/B test parameters"/>
        <Preference android:key="ab_test_export" android:title="ðŸ’¾ Export Data" android:summary="Export comparison data as JSON"/>
        <Preference android:key="ab_test_reset" android:title="ðŸ”„ Reset Test" android:summary="Clear all A/B test data"/>
      </PreferenceScreen>
      <PreferenceScreen android:key="neural_rollback" android:title="ðŸ”™ Rollback &amp; Recovery" android:summary="Model version management and automatic recovery">
        <Preference android:key="rollback_status" android:title="ðŸ“Š Version Status" android:summary="View current model version and health"/>
        <Preference android:key="rollback_history" android:title="ðŸ“œ Version History" android:summary="View all model versions and success rates"/>
        <CheckBoxPreference android:key="rollback_auto_enabled" android:title="Enable Auto-Rollback" android:summary="Automatically revert to previous version after repeated failures" android:defaultValue="true"/>
        <Preference android:key="rollback_manual" android:title="âš ï¸ Manual Rollback" android:summary="Force rollback to previous model version"/>
        <Preference android:key="rollback_pin_version" android:title="ðŸ“Œ Pin Version" android:summary="Lock current version (prevent automatic changes)"/>
        <Preference android:key="rollback_export" android:title="ðŸ’¾ Export History" android:summary="Export version history as JSON"/>
        <Preference android:key="rollback_reset" android:title="ðŸ”„ Reset History" android:summary="Clear all version data"/>
      </PreferenceScreen>
      <PreferenceScreen android:key="neural_privacy" android:title="ðŸ”’ Privacy &amp; Data" android:summary="Control data collection and privacy settings">
        <Preference android:key="privacy_status" android:title="ðŸ“Š Privacy Status" android:summary="View current privacy settings and consent status"/>
        <Preference android:key="privacy_consent" android:title="âœ… Data Collection Consent" android:summary="Grant or revoke consent for ML data collection"/>
        <PreferenceCategory android:title="Data Collection Controls">
          <CheckBoxPreference android:key="privacy_collect_swipe" android:title="Collect Swipe Data" android:summary="Allow collection of swipe gesture data for model training" android:defaultValue="true"/>
          <CheckBoxPreference android:key="privacy_collect_performance" android:title="Collect Performance Data" android:summary="Allow collection of prediction accuracy and latency statistics" android:defaultValue="true"/>
          <CheckBoxPreference android:key="privacy_collect_errors" android:title="Collect Error Logs" android:summary="Allow collection of error logs for debugging" android:defaultValue="false"/>
        </PreferenceCategory>
        <PreferenceCategory android:title="Privacy Settings">
          <CheckBoxPreference android:key="privacy_anonymize" android:title="Anonymize Data" android:summary="Remove identifying information from collected data" android:defaultValue="true"/>
          <CheckBoxPreference android:key="privacy_local_only" android:title="Local-Only Training" android:summary="Keep all data and training on this device only" android:defaultValue="true"/>
          <CheckBoxPreference android:key="privacy_allow_export" android:title="Allow Data Export" android:summary="Enable exporting collected data for external analysis" android:defaultValue="false"/>
          <CheckBoxPreference android:key="privacy_allow_sharing" android:title="Allow Model Sharing" android:summary="Enable sharing trained models with other devices" android:defaultValue="false"/>
        </PreferenceCategory>
        <PreferenceCategory android:title="Data Retention">
          <ListPreference android:key="privacy_retention_days" android:title="Retention Period" android:summary="How long to keep collected data" android:defaultValue="90" android:entries="@array/privacy_retention_entries" android:entryValues="@array/privacy_retention_values"/>
          <CheckBoxPreference android:key="privacy_auto_delete" android:title="Auto-Delete Old Data" android:summary="Automatically delete data older than retention period" android:defaultValue="true"/>
          <Preference android:key="privacy_delete_now" android:title="âš ï¸ Delete All Data Now" android:summary="Immediately delete all collected ML data"/>
        </PreferenceCategory>
        <Preference android:key="privacy_audit" android:title="ðŸ“œ Privacy Audit Trail" android:summary="View history of privacy-related actions"/>
        <Preference android:key="privacy_export" android:title="ðŸ’¾ Export Privacy Settings" android:summary="Export all privacy settings as JSON"/>
        <Preference android:key="privacy_reset" android:title="ðŸ”„ Reset Privacy Settings" android:summary="Reset to default privacy settings"/>
      </PreferenceScreen>
    </PreferenceScreen>
    <PreferenceScreen android:key="swipe_corrections" android:title="âœ¨ Swipe Corrections" android:summary="Adjust how accurately the keyboard corrects words when you swipe" android:dependency="swipe_typing_enabled">
      <CheckBoxPreference android:key="swipe_beam_autocorrect_enabled" android:title="Enable Beam Search Corrections" android:summary="Fuzzy match custom words and dictionary during prediction. Controls autocorrect while building suggestions." android:defaultValue="true"/>
      <CheckBoxPreference android:key="swipe_final_autocorrect_enabled" android:title="Enable Final Output Corrections" android:summary="Autocorrect the word that gets selected or auto-inserted after swiping" android:defaultValue="true"/>
      <Preference android:title="ðŸ“– About Swipe Corrections" android:summary="These settings control fuzzy matching and scoring for swipe predictions:\n\nâ€¢ Beam Search Corrections: Match custom words against neural predictions during search\nâ€¢ Final Output Corrections: Autocorrect the selected/auto-inserted word\nâ€¢ Scoring weights balance AI confidence vs dictionary frequency\nâ€¢ Tier boosts favor common vs rare words" android:dependency="swipe_beam_autocorrect_enabled"/>
      <ListPreference android:key="swipe_correction_preset" android:title="Correction Style" android:summary="%s" android:defaultValue="balanced" android:entries="@array/swipe_correction_preset_entries" android:entryValues="@array/swipe_correction_preset_values" android:dependency="swipe_beam_autocorrect_enabled"/>
      <PreferenceCategory android:title="Fuzzy Matching" android:dependency="swipe_beam_autocorrect_enabled">
        <ListPreference android:key="swipe_fuzzy_match_mode" android:title="Matching Algorithm" android:summary="%s" android:defaultValue="edit_distance" android:entries="@array/swipe_fuzzy_match_mode_entries" android:entryValues="@array/swipe_fuzzy_match_mode_values"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_max_length_diff" android:title="Typo Forgiveness" android:summary="How different in length a corrected word can be from your swipe path (%s chars). Higher values allow more corrections. (Default: 2)" android:defaultValue="2" min="0" max="5"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_prefix_length" android:title="Starting Letter Accuracy" android:summary="How many letters at the start of a word must match your swipe (%s letters). Higher is stricter. (Default: 2)" android:defaultValue="2" min="0" max="4"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_max_beam_candidates" android:title="Correction Search Depth" android:summary="Number of initial predictions to consider (%s). Higher may find better corrections but slower. (Default: 3)" android:defaultValue="3" min="1" max="10"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="autocorrect_char_match_threshold" android:title="Character Match Threshold" android:summary="How many characters must match (%s ratio). Higher is stricter. (Default: 0.67)" android:defaultValue="0.67" min="0.5" max="0.9"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="autocorrect_confidence_min_frequency" android:title="Minimum Frequency" android:summary="Only match custom words with frequency â‰¥ %s. (Default: 500)" android:defaultValue="500" min="100" max="5000"/>
      </PreferenceCategory>
      <PreferenceCategory android:title="Advanced Swipe Tuning">
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="swipe_prediction_source" android:title="Prediction Source" android:summary="Balance between dictionary and AI (%s%%). 0=Dictionary, 50=Balanced, 100=AI Model. (Default: 60)" android:defaultValue="60" min="0" max="100"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_common_words_boost" android:title="Common Words Boost" android:summary="How strongly to prefer the most common words (%s). Values >1.0 boost their priority. (Default: 1.3)" android:defaultValue="1.3" min="0.5" max="2.0"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_top5000_boost" android:title="Frequent Words Boost" android:summary="Broader boost for thousands of frequently used words (%s). (Default: 1.0)" android:defaultValue="1.0" min="0.5" max="2.0"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_rare_words_penalty" android:title="Rare Words Penalty" android:summary="How strongly to avoid suggesting very rare words (%s). Values &lt;1.0 make them less likely. (Default: 0.75)" android:defaultValue="0.75" min="0.0" max="1.5"/>
        <Preference android:key="reset_swipe_corrections" android:title="ðŸ”„ Reset Swipe Settings" android:summary="Reset all swipe correction settings to their original defaults"/>
      </PreferenceCategory>
    </PreferenceScreen>
    <PreferenceScreen android:key="swipe_debug" android:title="ðŸ› Swipe Debug Log" android:summary="Real-time swipe typing pipeline analysis and debugging" android:dependency="swipe_typing_enabled">
      <CheckBoxPreference android:key="swipe_debug_detailed_logging" android:title="Detailed Pipeline Logging" android:summary="Log trajectory processing, key detection, and neural network internals" android:defaultValue="false"/>
      <CheckBoxPreference android:key="swipe_debug_show_raw_output" android:title="Show Raw NN Output" android:summary="Always display at least 2 raw predictions before pruning" android:defaultValue="true"/>
      <CheckBoxPreference android:key="swipe_show_raw_beam_predictions" android:title="Show Raw Beam Predictions" android:summary="Display unfiltered beam search outputs (labeled with 'raw:' prefix) at end of suggestion bar" android:defaultValue="false"/>
      <Preference android:key="swipe_debug_info" android:title="ðŸ“– Debug Output" android:summary="Enable detailed logging to see:\n\nâ€¢ Trajectory path and key detection\nâ€¢ Neural network processing steps\nâ€¢ Beam search decoding progress\nâ€¢ Confidence scores and filtering\n\nLogs appear in the debug screen when enabled"/>
    </PreferenceScreen>
    <PreferenceScreen android:key="multilang_settings" android:title="ðŸŒ Multi-Language Support (Phase 8.3 &amp; 8.4)" android:summary="Enable automatic language detection and switching" android:dependency="swipe_typing_enabled">
      <CheckBoxPreference android:key="pref_enable_multilang" android:title="Enable Multi-Language" android:summary="Support multiple languages with automatic detection" android:defaultValue="false"/>
      <Preference android:title="ðŸ“– About Multi-Language" android:summary="Intelligent language detection and switching:\n\nâ€¢ Supports: English, Spanish, French, Portuguese, German\nâ€¢ Auto-detects language from typing context\nâ€¢ Switches models/dictionaries automatically\nâ€¢ Target latency: &lt;100ms per switch\nâ€¢ Privacy-first: All processing on-device\n\nRequires trained language models to function." android:dependency="pref_enable_multilang"/>
      <ListPreference android:key="pref_primary_language" android:title="Primary Language" android:summary="Default language (%s)" android:defaultValue="en" android:entries="@array/pref_language_entries" android:entryValues="@array/pref_language_values" android:dependency="pref_enable_multilang"/>
      <CheckBoxPreference android:key="pref_auto_detect_language" android:title="Auto-Detect Language" android:summary="Automatically switch language based on typing context" android:defaultValue="true" android:dependency="pref_enable_multilang"/>
      <juloo.keyboard2.prefs.SlideBarPreference android:key="pref_language_detection_sensitivity" android:title="Detection Sensitivity" android:summary="How confident detection must be to switch (%s)" android:defaultValue="0.6" min="0.4" max="0.9" android:dependency="pref_auto_detect_language"/>
      <Preference android:key="multilang_status" android:title="ðŸ“Š Language Status" android:summary="View loaded languages and memory usage" android:dependency="pref_enable_multilang"/>
    </PreferenceScreen>
    <CheckBoxPreference android:key="short_gestures_enabled" android:title="@string/pref_short_gestures_enabled_title" android:summary="@string/pref_short_gestures_enabled_summary" android:defaultValue="true"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="short_gesture_min_distance" android:title="@string/pref_short_gesture_distance_title" android:summary="@string/pref_short_gesture_distance_summary" android:defaultValue="30" min="10" max="95" android:dependency="short_gestures_enabled"/>
    <ListPreference android:key="circle_sensitivity" android:title="@string/pref_circle_sensitivity_title" android:summary="%s" android:defaultValue="2" android:entries="@array/pref_circle_sensitivity_entries" android:entryValues="@array/pref_circle_sensitivity_values"/>
    <ListPreference android:key="slider_sensitivity" android:title="@string/pref_slider_sensitivity_title" android:summary="%s" android:defaultValue="30" android:entries="@array/pref_slider_sensitivity_entries" android:entryValues="@array/pref_slider_sensitivity_values"/>
    <PreferenceScreen android:key="advanced_gesture_settings" android:title="âš™ï¸ Advanced Gesture Tuning" android:summary="Fine-tune tap, swipe, and slider timing thresholds">
      <PreferenceCategory android:title="Tap &amp; Typing">
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="tap_duration_threshold" android:title="Tap Duration Threshold" android:summary="Maximum duration for a tap gesture (%sms). Higher values make taps easier but may interfere with swipes." android:defaultValue="150" min="50" max="500"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="double_space_threshold" android:title="Double-Space-to-Period" android:summary="Maximum time between spaces to insert period (%sms). Set to 0 to disable." android:defaultValue="500" min="0" max="1000"/>
      </PreferenceCategory>
      <PreferenceCategory android:title="Swipe Recognition">
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_min_distance" android:title="Minimum Swipe Distance" android:summary="Minimum total distance to recognize a swipe (%s px). Lower allows shorter words like 'it', 'is'." android:defaultValue="50.0" min="20.0" max="100.0"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_min_key_distance" android:title="Minimum Key Distance" android:summary="Minimum distance between keys during swipe (%s px). Lower captures more keys but may add noise." android:defaultValue="40.0" min="15.0" max="80.0"/>
        <juloo.keyboard2.prefs.IntSlideBarPreference android:key="swipe_min_dwell_time" android:title="Minimum Key Dwell Time" android:summary="Minimum time to register a key during swipe (%sms). Lower values allow faster swiping." android:defaultValue="10" min="0" max="50"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_noise_threshold" android:title="Movement Noise Filter" android:summary="Minimum distance to register movement (%s px). Higher values filter jitter but may lose data." android:defaultValue="2.0" min="0.5" max="10.0"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="swipe_high_velocity_threshold" android:title="High Velocity Threshold" android:summary="Velocity for fast swipe detection (%s px/sec). Higher allows faster swipes." android:defaultValue="1000.0" min="200.0" max="2000.0"/>
      </PreferenceCategory>
      <PreferenceCategory android:title="Slider Key Behavior">
        <juloo.keyboard2.prefs.SlideBarPreference android:key="slider_speed_smoothing" android:title="Speed Smoothing" android:summary="Smoothing factor for slider movement (%s). Higher values are smoother but less responsive." android:defaultValue="0.7" min="0.1" max="0.95"/>
        <juloo.keyboard2.prefs.SlideBarPreference android:key="slider_speed_max" android:title="Maximum Speed Multiplier" android:summary="Maximum slider acceleration (%sx). Higher values allow faster sliding." android:defaultValue="4.0" min="1.0" max="10.0"/>
      </PreferenceCategory>
      <Preference android:key="gesture_tuning_info" android:title="â„¹ï¸ About These Settings" android:summary="These settings control low-level gesture recognition. If gestures feel laggy, reduce dwell time and noise threshold. If taps register as swipes, increase tap duration. Reset to defaults if typing becomes difficult." android:selectable="false"/>
    </PreferenceScreen>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="longpress_timeout" android:title="@string/pref_long_timeout_title" android:summary="%sms" android:defaultValue="600" min="50" max="2000"/>
    <CheckBoxPreference android:key="keyrepeat_enabled" android:title="@string/pref_keyrepeat_enabled" android:defaultValue="true"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="longpress_interval" android:dependency="keyrepeat_enabled" android:title="@string/pref_long_interval_title" android:summary="%sms" android:defaultValue="25" min="5" max="100"/>
    <CheckBoxPreference android:key="lock_double_tap" android:title="@string/pref_lock_double_tap_title" android:summary="@string/pref_lock_double_tap_summary" android:defaultValue="false"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="@string/pref_category_behavior">
    <CheckBoxPreference android:key="autocapitalisation" android:title="@string/pref_autocapitalisation_title" android:summary="@string/pref_autocapitalisation_summary" android:defaultValue="true"/>
    <CheckBoxPreference android:key="smart_punctuation" android:title="Smart Punctuation" android:summary="Attach punctuation to end of last word (removes space before period, comma, etc.)" android:defaultValue="true"/>
    <CheckBoxPreference android:key="switch_input_immediate" android:title="@string/pref_switch_input_immediate_title" android:summary="@string/pref_switch_input_immediate_summary" android:defaultValue="false"/>
    <CheckBoxPreference android:key="vibrate_custom" android:title="@string/pref_vibrate_custom" android:defaultValue="false"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:dependency="vibrate_custom" android:key="vibrate_duration" android:title="@string/pref_vibrate_duration_title" android:summary="%sms" android:defaultValue="20" min="0" max="100"/>
    <ListPreference android:key="number_entry_layout" android:title="@string/pref_number_entry_title" android:summary="%s" android:defaultValue="pin" android:entries="@array/pref_number_entry_entries" android:entryValues="@array/pref_number_entry_values"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="@string/pref_category_style">
    <ListPreference android:key="theme" android:title="@string/pref_theme" android:summary="%s" android:defaultValue="system" android:entries="@array/pref_theme_entries" android:entryValues="@array/pref_theme_values"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="label_brightness" android:title="@string/pref_label_brightness" android:summary="%s%%" android:defaultValue="100" min="50" max="100"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="keyboard_opacity" android:title="@string/pref_keyboard_opacity" android:summary="%s%%" android:defaultValue="100" min="0" max="100"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="key_opacity" android:title="@string/pref_key_opacity" android:summary="%s%%" android:defaultValue="100" min="0" max="100"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="key_activated_opacity" android:title="@string/pref_key_activated_opacity" android:summary="%s%%" android:defaultValue="100" min="0" max="100"/>
    <PreferenceScreen android:title="@string/pref_margin_bottom_title">
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="margin_bottom_portrait" android:title="@string/pref_portrait" android:summary="%sdp" android:defaultValue="7" min="0" max="100"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="margin_bottom_landscape" android:title="@string/pref_landscape" android:summary="%sdp" android:defaultValue="3" min="0" max="100"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="margin_bottom_portrait_unfolded" android:title="@string/pref_portrait_unfolded" android:summary="%sdp" android:defaultValue="7" min="0" max="100"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="margin_bottom_landscape_unfolded" android:title="@string/pref_landscape_unfolded" android:summary="%sdp" android:defaultValue="3" min="0" max="100"/>
    </PreferenceScreen>
    <PreferenceScreen android:title="@string/pref_keyboard_height_title">
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="keyboard_height" android:title="@string/pref_portrait" android:summary="%s%%" android:defaultValue="35" min="10" max="100"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="keyboard_height_landscape" android:title="@string/pref_landscape" android:summary="%s%%" android:defaultValue="50" min="20" max="65"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="keyboard_height_unfolded" android:title="@string/pref_portrait_unfolded" android:summary="%s%%" android:defaultValue="35" min="10" max="50"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="keyboard_height_landscape_unfolded" android:title="@string/pref_landscape_unfolded" android:summary="%s%%" android:defaultValue="50" min="20" max="65"/>
    </PreferenceScreen>
    <PreferenceScreen android:title="@string/pref_horizontal_margin_title">
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="horizontal_margin_portrait" android:title="@string/pref_portrait" android:summary="%sdp" android:defaultValue="3" min="0" max="30"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="horizontal_margin_landscape" android:title="@string/pref_landscape" android:summary="%sdp" android:defaultValue="28" min="0" max="200"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="horizontal_margin_portrait_unfolded" android:title="@string/pref_portrait_unfolded" android:summary="%sdp" android:defaultValue="3" min="0" max="30"/>
      <juloo.keyboard2.prefs.IntSlideBarPreference android:key="horizontal_margin_landscape_unfolded" android:title="@string/pref_landscape_unfolded" android:summary="%sdp" android:defaultValue="28" min="0" max="200"/>
    </PreferenceScreen>
    <juloo.keyboard2.prefs.SlideBarPreference android:key="character_size" android:title="@string/pref_character_size_title" android:summary="@string/pref_character_size_summary" android:defaultValue="1.15" min="0.75" max="1.5"/>
    <juloo.keyboard2.prefs.SlideBarPreference android:key="key_vertical_margin" android:title="@string/pref_key_vertical_space" android:summary="%s%%" android:defaultValue="1.5" min="0" max="5"/>
    <juloo.keyboard2.prefs.SlideBarPreference android:key="key_horizontal_margin" android:title="@string/pref_key_horizontal_space" android:summary="%s%%" android:defaultValue="2" min="0" max="5"/>
    <CheckBoxPreference android:key="border_config" android:title="@string/pref_border_config_title" android:defaultValue="false"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="custom_border_radius" android:title="@string/pref_corners_radius_title" android:summary="%s%%" android:defaultValue="0" min="0" max="100" android:dependency="border_config"/>
    <juloo.keyboard2.prefs.SlideBarPreference android:key="custom_border_line_width" android:title="@string/pref_border_width_title" android:summary="%sdp" android:defaultValue="0" min="0" max="5" android:dependency="border_config"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="@string/pref_category_clipboard">
    <CheckBoxPreference android:key="clipboard_history_enabled" android:title="@string/pref_clipboard_history_enabled_title" android:summary="@string/pref_clipboard_history_enabled_summary" android:defaultValue="false"/>
    <ListPreference android:key="clipboard_limit_type" android:title="History limit type" android:summary="Choose between count-based or size-based limit" android:dependency="clipboard_history_enabled" android:defaultValue="count" android:entries="@array/pref_clipboard_limit_type_entries" android:entryValues="@array/pref_clipboard_limit_type_values"/>
    <ListPreference android:key="clipboard_history_limit" android:title="@string/pref_clipboard_history_limit_title" android:summary="@string/pref_clipboard_history_limit_summary" android:dependency="clipboard_history_enabled" android:defaultValue="6" android:entries="@array/pref_clipboard_history_limit_entries" android:entryValues="@array/pref_clipboard_history_limit_values"/>
    <ListPreference android:key="clipboard_size_limit_mb" android:title="Maximum total size" android:summary="Total storage size limit for clipboard history" android:dependency="clipboard_history_enabled" android:defaultValue="10" android:entries="@array/pref_clipboard_size_limit_mb_entries" android:entryValues="@array/pref_clipboard_size_limit_mb_values"/>
    <juloo.keyboard2.prefs.IntSlideBarPreference android:key="clipboard_pane_height_percent" android:title="Clipboard pane height" android:summary="%s%%" android:defaultValue="30" min="10" max="50"/>
    <ListPreference android:key="clipboard_pinned_rows" android:title="Pinned section size" android:summary="Number of pinned entries to display" android:dependency="clipboard_history_enabled" android:defaultValue="100" android:entries="@array/pref_clipboard_pinned_rows_entries" android:entryValues="@array/pref_clipboard_pinned_rows_values"/>
    <ListPreference android:key="clipboard_max_item_size_kb" android:title="Maximum size per item" android:summary="Prevent accidentally clipping large text" android:dependency="clipboard_history_enabled" android:defaultValue="500" android:entries="@array/pref_clipboard_max_item_size_entries" android:entryValues="@array/pref_clipboard_max_item_size_values"/>
    <Preference android:key="clipboard_storage_stats" android:title="Clipboard usage" android:summary="Loading statistics..." android:dependency="clipboard_history_enabled" android:selectable="false"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="Backup &amp; Restore">
    <Preference android:key="backup_config" android:title="Export Configuration" android:summary="Save all settings to kb-config.json"/>
    <Preference android:key="restore_config" android:title="Import Configuration" android:summary="Restore settings from kb-config.json"/>
    <Preference android:key="export_custom_dictionary" android:title="Export Custom Dictionary" android:summary="Save custom words, frequencies, and disabled words to JSON"/>
    <Preference android:key="import_custom_dictionary" android:title="Import Custom Dictionary" android:summary="Import custom words and disabled words (merges without duplicates)"/>
    <Preference android:key="export_clipboard_history" android:title="Export Clipboard History" android:summary="Save clipboard entries (active and pinned) to JSON"/>
    <Preference android:key="import_clipboard_history" android:title="Import Clipboard History" android:summary="Import clipboard entries (merges without duplicates)"/>
  </PreferenceCategory>
  <PreferenceCategory android:title="About">
    <Preference android:key="version_info" android:title="Version Info" android:summary="Loading version info..."/>
    <Preference android:key="check_updates" android:title="ðŸ”„ Check for Updates" android:summary="Check GitHub for new releases"/>
    <Preference android:key="update_app" android:title="Install Update" android:summary="Install update from /sdcard/unexpected/debug-kb.apk"/>
  </PreferenceCategory>
</PreferenceScreen>
